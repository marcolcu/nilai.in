<div id="table-user-main" class="relative overflow-x-auto shadow-md sm:rounded-lg">
    <table class="w-full text-sm text-left rtl:text-right bg-white text-gray-500">
        <thead class="text-xs text-gray-700 uppercase bg-gray-50">
            <tr>
                <th scope="col" class="px-6 py-3">
                    No
                </th>
                <th scope="col" class="px-6 py-3">
                    Materi
                </th>
                <th scope="col" class="px-6 py-3">
                    Judul
                </th>
                <th scope="col" class="px-6 py-3">
                    Deskripsi
                </th>
                <th scope="col" class="px-6 py-3">
                    Tipe Materi
                </th>
            </tr>
        </thead>
        <tbody id="table-body-user">
            <!-- table rows will be generated here -->
        </tbody>

        <tbody id="skeleton-loader-table-user">
            <!-- Skeleton Loading Rows -->
            <tr class="bg-white border-b animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
            <tr class="bg-white border-b animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
            <tr class="bg-white border-b animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
            <tr class="bg-white border-b animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
            <tr class="bg-white border-b animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
            <tr class="bg-white border-b animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
            <tr class="bg-white border-b animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
            <tr class="bg-white animate-pulse">
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/2"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4">
                    <div class="h-4 bg-gray-200 rounded w-1/4"></div>
                </td>
                <td class="px-6 py-4 text-right">
                    <div class="h-4 bg-gray-200 rounded w-1/4 mx-auto"></div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
</div>

@section('js-table')
<script>
    $(document).ready(function() {
            $('#skeleton-loader-table-user').show();
            $('#table-body-user').hide();
            $('#pagination-container').hide();

            table_materi();

            var currentPage = 1;
            var entriesPerPage = 10;
            var allData = [];

            function table_materi() {
                $('#skeleton-loader-table-user').show();
                $('#table-body-user').hide();
                $('#table-body-user').empty();
                $.ajax({
                    url: "api/materiMapel",
                    type: "GET",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    success: function(response) {
                        allData = response["$materiMataPelajaran: "];
                        if (allData && allData.length > 0) {
                            allData.sort(function(a, b) {
                                return b.id - a.id;
                            });

                            renderTable(currentPage);
                            $('#pagination-container').show();
                        } else {
                            var row = `
                            <tr>
                                <th scope="row" colspan="6" class="px-6 py-4 font-medium text-center text-gray-900 whitespace-nowrap">
                                    No data found
                                </th>
                            </tr>
                            `;
                            $('#table-body-user').append(row);
                            $('#pagination-container').hide();
                        }
                        $('#skeleton-loader-table-user').hide();
                        $('#table-body-user').show();
                    },
                    error: function(xhr, status, error) {
                        console.error(error);
                        var row = `
                        <tr>
                            <th scope="row" colspan="6" class="px-6 py-4 font-medium text-center text-gray-900 whitespace-nowrap">
                                Fetching data error..
                            </th>
                        </tr>
                        `;
                        $('#table-body-user').append(row);
                        $('#pagination-container').hide();
                        $('#skeleton-loader-table-user').hide();
                        $('#table-body-user').show();
                    }
                });
            }

            function renderTable(page) {
                $('#table-body-user').empty();
                var start = (page - 1) * entriesPerPage;
                var end = start + entriesPerPage;
                var paginatedData = allData.slice(start, end);
                paginatedData.forEach(function(item, index) {
                    var row = `
                        <tr>
                            <th scope="row" class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap">
                                ${start + index + 1}
                            </th>
                            <td class="px-6 py-4">
                                ${item.mapel}
                            </td>
                            <td class="px-6 py-4">
                                ${item.judul}
                            </td>
                            <td class="px-6 py-4 capitalize">
                                ${item.deskripsi}
                            </td>
                            <td class="px-6 py-4 capitalize">
                                ${item.tipe}
                            </td>
                        </tr>
                    `;
                    $('#table-body-user').append(row);
                });
            }
        });
</script>
@endsection